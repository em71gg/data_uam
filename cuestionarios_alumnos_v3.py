import pandas as pd



campos_permitidos = {
    "alumno_id": 1,
    "codigo_clase": "9HUKDMTF",
    "auton1": 6,
    "condeval1": 3,
    "conprevio1": 4,
    "pasoapaso1": 2,
    "particip1": 5,
    "dedica1": 7,
    "clarorg1": 5,
    "equidad1": 7,
    "conprevio2": 8,
    "errorpos1": 2,
    "elogio1": 4,
    "dedica2": 3,
    "conecta1": 5,
    "ejemplos1": 4,
    "elogio2": 7,
    "mensapren1": 5,
    "condeval2": 6,
    "clarobj1": 4,
    "clarorg2": 6,
    "ejemplos2": 6,
    "errorpos2": 7,
    "ritmorel1": 8,
    "mensapren2": 4,
    "equidad2": 5,
    "novedad1": 5,
    "conecta2": 3,
    "ritmorel2": 5,
    "clarobj2": 6,
    "auton2": 5,
    "particip2": 5,
    "pasoapaso2": 4,
    "novedad2": 3,
    "CDC1": 4,
    "CDC2": 7,
    "CDC3": 3,
    "CDC4": 5,
    "CDC5": 4,
    "CDC6": 7,
    "CDC7": 4,
    "CDC8": 5,
    "CDC9": 4,
    "CDC10": 6,
    "CDC11": 5,
    "CDC12": 3,
    "CDC13": 4,
    "CDC14": 3,
    "CDC15": 4,
    "CEM01": 6,
    "CEM02": 7,
    "CEM03": 4,
    "CEM04": 3,
    "CEM05": 3,
    "CEM06": 2,
    "CEM07": 4,
    "CEM08": 3,
    "CEM09": 6,
    "CEM10": 4,
    "CEM11": 3,
    "CEM12": 5,
    "CEM13": 3,
    "CEM14": 1,
    "CEM15": 5,
    "CEM16": 4,
    "CV01": 2,
    "CV02": 3,
    "CV03": 4,
    "CV04": 1,
    "CV05": 5,
    "CV06": 2,
    "CV07": 4,
    "CV08": 3,
    "CV09": 1,
    "CV10": 5,
    "CV11": 2,
    "CV12": 3,
    "CV13": 4,
    "CV14": 1,
    "CV15": 5,
    "CV16": 2,
    "CV17": 4,
    "CV18": 3,
    "CV19": 1,
    "CV20": 5,
    "CV21": 2,
    "CV22": 3,
    "CV23": 4,
    "CV24": 1,
    "CV25": 5,
    "CV26": 2,
    "CV27": 3,
    "CV28": 4,
    "CV29": 1,
    "CV30": 5,
    "CV31": 2,
    "CV32": 3,
    "CV33": 4,
    "CV34": 1,
    "CV35": 5,
    "CV36": 2,
    "CV37": 3,
    "CV38": 4,
    "CV39": 1,
    "CV40": 5,
    "CV41": 2,
    "CV42": 3,
    "CV43": 4,
    "CV44": 1,
    "CV45": 5,
    "CV46": 2,
    "CV47": 3,
    "CV48": 4,
    "P_COSTO1": 1,
    "C_COMPET1": 3,
    "P_COSTO2": 2,
    "C_COMPET2": 4,
    "P_COSTO3": 5,
    "C_COMPET3": 1,
    "MOT01APR": 3,
    "MOT02RES": 2,
    "MOT03EVIT": 5,
    "MOT04RES": 4,
    "MOT05EVIT": 1,
    "MOT06APR": 3,
    "MOT07EVIT": 2,
    "MOT08APR": 5,
    "MOT09RES": 4,
    "EXP01CG": 3,
    "EXP02CC": 4,
    "EXP03HM": 5,
    "EXP04CE": 1,
    "EXP05HS": 2,
    "EXP06HC": 3,
    "EXP07CM": 4,
    "EXP08HE": 5,
    "EXP09CS": 1,
    "EXP10HG": 2,
    "INTSOCN1": 3,
    "INTSOCP1": 4,
    "INTSOCN2": 5,
    "INTSOCP2": 1,
    "INTSOCN3": 2,
    "INTSOCP3": 3,
    "INTSOCN4": 4,
    "INTSOCP4": 5,
    "INTSOCN5": 1,
    "INTSOCP5": 2,
    "INTSOCN6": 3,
    "INTSOCP6": 4,
    "expresult1": 5,
    "interes1": 4,
    "habilper1": 3,
    "satisfapren1": 2,
    "esfuerzo1": 1,
    "expresult2": 2,
    "interes2": 3,
    "satisfapren2": 4,
    "habilper2": 5,
    "esfuerzo2": 1,
    "expresult3": 2,
    "satisfapren3": 3,
    "habilper3": 4,
    "interes3": 5,
    "esfuerzo3": 1,
    "satisfapren4": 2,
    "CRITCDC1": 3,
    "CRITCDC2": 4,
    "CRITCEM1": 5,
    "CRITCDC3": 1,
    "CRITCDC4": 2,
    "CRITCEM2": 3,
    "CRITCDC5": 4,
    "CRITCDC6": 5,
    "CRITCEM3": 1,
    "CRITCDC7": 2,
    "CRITCDC8": 3,
    "CRITCEM4": 4
}
# 1. Cargamos tu CSV limpio
df = pd.read_csv("datos_finales_para_cuestionarios.csv", sep=";", encoding="utf-8")  # o el que hayas limpiado antes

# 2. Definimos las columnas que te interesan (las claves del diccionario)
campos_deseados = list(campos_permitidos.keys())

print(campos_deseados)

# 3. Verificamos que todas existan (por si alguna cambió de nombre)
columnas_faltantes = [col for col in campos_deseados if col not in df.columns]
if columnas_faltantes:
    print("Faltan columnas:", columnas_faltantes)
else:
    print("¡Todas las columnas están presentes!")

# 4. ¡Magia! Convertimos todo el DataFrame a lista de diccionarios perfectos
registros = df[campos_deseados].to_dict('records')

# Ejemplo: ver el primer alumno
print("Primer registro:")
for k, v in registros[0].items():
    print(f"  {k}: {v}")

# Si quieres guardarlo como JSON (ideal para APIs, MongoDB, etc.)
import json
with open("alumnos_limpios.json", "w", encoding="utf-8") as f:
    json.dump(registros, f, ensure_ascii=False, indent=2)